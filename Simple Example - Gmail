; Gmail
#Include OnWebsite.ahk
#Include UIA-v2-main\Lib\UIA.ahk
#Include UIA-v2-main\Lib\UIA_Browser.ahk


#HotIf On.Website("mail.google.com")
; Control + n to create new message
^n::{ 
    Send "c"  
}

;Control + d  or ^Capslock to delete a message or draft. This utilizes the UIA version 2 library by Descolada. I like using ElementFromHandle(WinActive("A") || WinExist("A")) to restrict the search to the currently active page. 
^d::
^Capslock::
{ 
SetCapsLockState("Off")
    Try { 
       browserEl := UIA.ElementFromHandle(WinActive("A") || WinExist("A"))
       browserEl.WaitElement({LocalizedType:"button", Name:"Delete"}, 100).Click() 
    } 
    catch{
        try
            {
            browserEl := UIA.ElementFromHandle(WinActive("A") || WinExist("A"))            
            browserEl.WaitElement({LocalizedType:"text", Name:"Discard drafts"}, 1000).Click()
            }
       }
    }

; Search all emails with control f (instead of find on page)
^f::{ 
    Try UIA.ElementFromHandle(WinActive("A") || WinExist("A")).WaitElement({Name:"Search mail", LocalizedType:"edit"}, 1000).ControlClick() 
    Send "^{a}"
}

; Find on page shortcut remapped control shift f
^+f::{ 
    Send "^{f}" 
}

#Hotif
